# Zero Knowledge Swarm (ZKS) Protocol Specification (v2.0)

**Status**: Draft
**Author**: Wasif Faisal (ZKS Team)
**Date**: 2025-12-17
**License**: AGPLv3
**Copyright**: Â© 2025 Wasif Faisal. The concepts "Faisal-Swarm Topology" and "ZKS Protocol" are original inventions of the author.

## 1. Abstract
The ZKS-Revised Protocol is a trustless, metadata-free overlay network designed to provide stronger anonymity than Tor. It eliminates the "Direct Connection" vulnerability of onion routing by introducing **Blind Relays** and replaces trusted directory authorities with **Swarm Entropy** for key generation.

## 2. Network Topology: "Faisal-Swarm" (Triple-Blind Architecture)

Unlike Tor, where nodes connect directly (revealing IPs to each other), ZKS uses the **Faisal-Swarm Topology**. Nodes communicate exclusively through a Blind Relay, creating a "Split Knowledge" graph.

### Architecture
```
[Client] --(Encrypted Tunnel A)--> [Blind Relay] --(Encrypted Tunnel B)--> [Exit Peer]
```

### The Three Blinds
1.  **Client Blindness**: The Client does not know the Exit Peer's IP (only the Relay's).
2.  **Exit Blindness**: The Exit Peer does not know the Client's IP (only the Relay's).
3.  **Relay Blindness**: The Relay knows both IPs but cannot decrypt the traffic (see Section 3).

**Guarantee**: No single entity in the network possesses both the Source IP and the Destination Data.

## 3. Encryption: "Wasif-Vernam Cipher" (Double-Key Vernam)

Traffic is encrypted using the **Wasif-Vernam Cipher**, a distributed variant of the One-Time Pad ensuring Information-Theoretic Security.

$$ Ciphertext = Plaintext \oplus K_{Local} \oplus K_{Remote} $$

*   **$K_{Local}$**: Generated by the Client (CSPRNG). Never leaves the device.
*   **$K_{Remote}$**: Generated by the Swarm (see Section 4).
*   **Property**: Without $K_{Local}$, the Ciphertext is mathematically indistinguishable from random noise.

## 4. Trustless Key Generation: "Swarm Entropy"

To eliminate trust in any single RNG (including Cloudflare's), $K_{Remote}$ is derived from the network itself.

### The "Entropy Tax"
Every active peer in the ZKS Network is required to provide a stream of random bytes to the Relay.
*   **Implementation**: Peers MUST use a Cryptographically Secure PRNG (CSPRNG) seeded by OS entropy (e.g., Rust's `getrandom` crate).
*   **Sources**: CPU Thermal Noise (`RDRAND`), Interrupt Timing, User Input.
*   **Quality**: This distributed entropy is cryptographically superior to centralized solutions (like LavaRand) because it eliminates the single point of failure.

### Key Derivation Function
When a Client initiates a session, the Relay selects $N$ random active peers ($P_1, P_2, ..., P_N$) and requests entropy chunks ($E$).

$$ K_{Remote} = E_{P1} \oplus E_{P2} \oplus ... \oplus E_{PN} $$

*   **Security Model**: For an attacker to predict $K_{Remote}$, they must control **ALL $N$** selected peers.
*   **Default $N$**: 10.

## 5. Traffic Analysis Defense

To defeat Global Timing Analysis, ZKS mandates **Constant Rate Padding (CRP)**.

*   **Mechanism**: All tunnels must maintain a constant bitrate (e.g., 50 Mbps).
*   **Padding**: If the user is idle, the Client fills the tunnel with dummy encrypted frames.
*   **Result**: An observer sees a flat line of traffic, making it impossible to correlate burst patterns between Entry and Exit.

## 6. Application Layer

### A. SOCKS5 Mode (Standard)
*   **Usage**: General purpose VPN.
*   **Behavior**: Client acts as a SOCKS5 server, tunneling TCP/UDP traffic to the Exit Peer.

### B. ZKS Browser Control Protocol (ZBCP)
*   **Usage**: Ultra-secure browsing.
*   **Behavior**:
    *   Client sends JSON commands (`Click`, `Scroll`, `Type`).
    *   Exit Peer runs Headless Chrome and returns DOM updates or Video chunks.
    *   **Benefit**: "Air Gap" security. Malicious JS executes on the Exit Peer, not the Client.
